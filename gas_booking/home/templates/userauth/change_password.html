{% extends "base.html" %}

{% load static %}
{% block title %}Change Password{% endblock %}

{% block extra_css %}
<style>
form i {
    cursor: pointer;
    color: #2aa198;
    float: right;
    margin-top: -30px;
    margin-right: 10px;

}</style>
{% endblock %}

{% block content %}
<div class="card border-primary" style="width: 50rem; margin-left: 350px; margin-top: 100px;">
    <div class="card-header"><h1 class="text-center">Change Password</h1></div>

    {% for msg in messages %}
    <p class="text-success text-center">{{msg}}</p>
    {% endfor %}

    <form method="POST" novalidate action="{% url 'change_password' %}"> {% csrf_token %}
        <div class="container">
            <div class="form-group mt-2">
                {{password_change_form.old_password.label}}
                <small style="margin-left: 20px;" class="text-danger"> {{password_change_form.old_password.errors.as_text }}</small>
                {{password_change_form.old_password}}
                <i class="fa fa-eye" id="togglePassword1" style="font-size: 20px;"></i>
            </div>
            <div class="form-group mt-2">
                {{password_change_form.new_password1.label}}
                <small style="margin-left: 20px;" class="text-danger"> {{password_change_form.new_password1.errors.as_text }}</small>
                {{password_change_form.new_password1}}
                <i class="fa fa-eye" id="togglePassword2" style="font-size: 20px;"></i>
            </div>
            <div class="form-group mt-2 mb-3">
                {{password_change_form.new_password2.label}}
                <small style="margin-left: 20px;" class="text-danger"> {{password_change_form.new_password2.errors.as_text }}</small>
                {{password_change_form.new_password2}}
            </div>
        </div>
            
        <div class="card-footer">
            <input type="submit" class="btn btn-primary" style="width: 40rem; margin-left: 50px !important;" value="Change Password">
            <input type="button" onclick="history.back()" class="btn btn-danger mt-2" style="width: 40rem; margin-left: 50px !important;" value="Go Back">
        </div> 
    </form>   
</div>
{% endblock %}

{% block extra_js %}
<script>
    const togglePassword1 = document.querySelector('#togglePassword1');
    const togglePassword2 = document.querySelector('#togglePassword2');

    const password1 = document.querySelector('#id_old_password');
    const password2 = document.querySelector('#id_new_password1');
    const password3 = document.querySelector('#id_new_password2');
    
    togglePassword1.addEventListener('click', function (e) {
        // toggle the type attribute
        const type1 = password1.getAttribute('type') === 'password' ? 'text' : 'password';

        password1.setAttribute('type', type1);

        // toggle the eye slash icon
        this.classList.toggle('fa-eye-slash');
    });
    togglePassword2.addEventListener('click', function (e) {
        // toggle the type attribute
        const type1 = password2.getAttribute('type') === 'password' ? 'text' : 'password';
        const type2 = password3.getAttribute('type') === 'password' ? 'text' : 'password';

        password2.setAttribute('type', type1);
        password3.setAttribute('type', type2);

        // toggle the eye slash icon
        this.classList.toggle('fa-eye-slash');
    });

</script>
{% endblock %}
